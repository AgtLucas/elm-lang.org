<!DOCTYPE HTML>
<html><head><meta charset="UTF-8"><title>Pong</title><style type="text/css">html,head,body { padding:0; margin:0; }body { font-family: helvetica, arial, sans-serif; }</style></head><body><script type="text/javascript" src="/elm-mini.js"></script><script type="text/javascript">
var FrameRate = function() {

var desiredFPS = 40;
var msPerFrame = 1000 / desiredFPS;

// Set the desired rate of frames per second.
// Default is 40 if no desiredFPS event is triggered.
document.addEventListener('desiredFPS', function(e) {
	console.log(e.value);
	desiredFPS = e.value;
	msPerFrame = 1000 / desiredFPS;
    });


var date = new Date();
var startTime = date.getTime();
var frameStart = startTime;
var frameEnd   = startTime;
var timeoutID = 0;

// Trigger time events to try to maintain the desired FPS.
document.addEventListener('finished', function(evt) {
	clearTimeout(timeoutID);
	date = new Date();
	frameEnd = date.getTime();
	var diff = frameEnd - frameStart;
	var waitTime = Math.max(msPerFrame-diff,3);
	timeoutID = setTimeout(function() {
		date = new Date();
		frameStart = date.getTime();
		var e = document.createEvent('Event');
		e.initEvent('trigger', true, true);
		e.value = (frameStart - startTime) / 1000;
		document.dispatchEvent(e);
	    }, waitTime);
    });

}();
try{

for(var i in Elm) { this[i] = Elm[i]; }
if (Elm.Pong) throw "Module name collision, 'Pong' is already defined."; 
Elm.Pong=function(){
 try{if (!(Elm.Prelude instanceof Object)) throw 'module not found'; } catch(e) {throw "Module 'Prelude' is missing. Compile with --make flag or load missing module in a separate JavaScript file.";}
 var hiddenVars=[];
 for(var i in Elm.Prelude){
  if (hiddenVars.indexOf(i) >= 0) continue;
  this[i]=Elm.Prelude[i];}
 try{if (!(Elm.JavaScript instanceof Object)) throw 'module not found'; } catch(e) {throw "Module 'JavaScript' is missing. Compile with --make flag or load missing module in a separate JavaScript file.";}
 var hiddenVars=[];
 for(var i in Elm.JavaScript){
  if (hiddenVars.indexOf(i) >= 0) continue;
  this[i]=Elm.JavaScript[i];}
 try{if (!(Elm.Keyboard.Raw instanceof Object)) throw 'module not found'; } catch(e) {throw "Module 'Keyboard.Raw' is missing. Compile with --make flag or load missing module in a separate JavaScript file.";}
 var hiddenVars=[];
 for(var i in Elm.Keyboard.Raw){
  if (hiddenVars.indexOf(i) >= 0) continue;
  this[i]=Elm.Keyboard.Raw[i];}
 try{if (!(Elm.Window instanceof Object)) throw 'module not found'; } catch(e) {throw "Module 'Window' is missing. Compile with --make flag or load missing module in a separate JavaScript file.";}
 var Win=Elm.Window;
 var Up_4=["Up"];
 var Neutral_5=["Neutral"];
 var Down_6=["Down"];
 function KeyInput_7(a1){
  return function(a2){
   return function(a3){
    return ["KeyInput",a1,a2,a3];};};};
 function Input_14(a1){
  return function(a2){
   return ["Input",a1,a2];};};
 function Paddle_16(a1){
  return ["Paddle",a1];};
 function Ball_17(a1){
  return function(a2){
   return ["Ball",a1,a2];};};
 function Score_18(a1){
  return function(a2){
   return ["Score",a1,a2];};};
 var Play_19=["Play"];
 var BetweenRounds_20=["BetweenRounds"];
 function GameState_21(a1){
  return function(a2){
   return function(a3){
    return function(a4){
     return function(a5){
      return ["GameState",a1,a2,a3,a4,a5];};};};};};
 var desiredFPS_0=constant(castIntToJSNumber(30));
 var jsTime_1 = Elm.Signal.constant(castIntToJSNumber(0));
 Value.addListener(document, 'trigger', function(e) { Dispatcher.notify(jsTime_1.id, e.value); });
 var time_2=lift(castJSNumberToFloat)(jsTime_1);
 var delta_3=lift(snd)(foldp(function(t1_40){
  return function(Tuple2$t0d_41){
   return function(){
   switch(Tuple2$t0d_41[0]){
    case "Tuple2":
    return ["Tuple2",t1_40,(t1_40-Tuple2$t0d_41[1])];
   }
   throw "Non-exhaustive pattern match in case";}();};})(["Tuple2",0,0])(time_2));
 var defaultKeyInput_8=KeyInput_7(false)(Neutral_5)(Neutral_5);
 var updateDirection1_10=updateDirection_9(87)(83);
 var updateDirection2_11=updateDirection_9(38)(40);
 var keyInput_13=lift(foldl(updateInput_12)(defaultKeyInput_8))(keysDown);
 var input_15=sampleOn(delta_3)(lift2(Input_14)(delta_3)(keyInput_13));
 var gameWidth_22=600;
 var gameHeight_23=400;
 var halfWidth_24=(gameWidth_22/2);
 var halfHeight_25=(gameHeight_23/2);
 var defaultGame_26=GameState_21(BetweenRounds_20)(Score_18(0)(0))(Ball_17(["Tuple2",halfWidth_24,halfHeight_25])(["Tuple2",150,150]))(Paddle_16(halfHeight_25))(Paddle_16(halfHeight_25));
 var gameState_34=foldp(stepGame_33)(defaultGame_26)(input_15);
 var view_37=lift2(display_36)(Win.dimensions)(gameState_34);
 var done_38=lift(function(__130){
  return castBoolToJSBool(true);})(view_37);
 var main_39=view_37;
 function updateDirection_9(upKey_44){
  return function(downKey_45){
   return function(key_46){
    return function(direction_47){
     return function(){
     switch(direction_47[0]){
      case "Down":
      return (eq(key_46,upKey_44)?Neutral_5:Down_6);
      case "Neutral":
      return (eq(key_46,upKey_44)?Up_4:(eq(key_46,downKey_45)?Down_6:Neutral_5));
      case "Up":
      return (eq(key_46,downKey_45)?Neutral_5:Up_4);
     }
     throw "Non-exhaustive pattern match in case";}();};};};};
 function updateInput_12(key_48){
  return function(KeyInput$spacedir1dir2_49){
   return function(){
   switch(KeyInput$spacedir1dir2_49[0]){
    case "KeyInput":
    return KeyInput_7((KeyInput$spacedir1dir2_49[1]||eq(key_48,32)))(updateDirection1_10(key_48)(KeyInput$spacedir1dir2_49[2]))(updateDirection2_11(key_48)(KeyInput$spacedir1dir2_49[3]));
   }
   throw "Non-exhaustive pattern match in case";}();};};
 function stepPaddle_27(delta_53){
  return function(dir_54){
   return function(Paddle$y_55){
    return function(){
    switch(Paddle$y_55[0]){
     case "Paddle":
     return function(){
     switch(dir_54[0]){
      case "Down":
      return Paddle_16(clamp(20)((gameHeight_23-20))((Paddle$y_55[1]+(200*delta_53))));
      case "Neutral":
      return Paddle_16(Paddle$y_55[1]);
      case "Up":
      return Paddle_16(clamp(20)((gameHeight_23-20))((Paddle$y_55[1]-(200*delta_53))));
     }
     throw "Non-exhaustive pattern match in case";}();
    }
    throw "Non-exhaustive pattern match in case";}();};};};
 function makePositive_28(n_57){
  return ((compare(n_57)(0)[0] === 'GT')?n_57:(0-n_57));};
 function makeNegative_29(n_58){
  return ((compare(n_58)(0)[0] === 'GT')?(0-n_58):n_58);};
 function within_30(epsilon_59){
  return function(n_60){
   return function(x_61){
    return ((compare(x_61)((n_60-epsilon_59))[0] === 'GT')&&(compare(x_61)((n_60+epsilon_59))[0] === 'LT'));};};};
 function stepVelocity_31(velocity_62){
  return function(lowerCollision_63){
   return function(upperCollision_64){
    return (lowerCollision_63?makePositive_28(velocity_62):(upperCollision_64?makeNegative_29(velocity_62):velocity_62));};};};
 function stepBall_32(delta_65){
  return function(Ball$Tuple2$xyTuple2$vxvy_66){
   return function(Paddle$y1_67){
    return function(Paddle$y2_68){
     return function(){
     switch(Ball$Tuple2$xyTuple2$vxvy_66[0]){
      case "Ball":
      switch(Ball$Tuple2$xyTuple2$vxvy_66[1][0]){
       case "Tuple2":
       switch(Ball$Tuple2$xyTuple2$vxvy_66[2][0]){
        case "Tuple2":
        return function(){
        switch(Paddle$y1_67[0]){
         case "Paddle":
         return function(){
         switch(Paddle$y2_68[0]){
          case "Paddle":
          return function(){
           var hitPaddle1_75=(within_30(20)(Paddle$y1_67[1])(Ball$Tuple2$xyTuple2$vxvy_66[1][2])&&within_30(8)(25)(Ball$Tuple2$xyTuple2$vxvy_66[1][1]));
           var hitPaddle2_76=(within_30(20)(Paddle$y2_68[1])(Ball$Tuple2$xyTuple2$vxvy_66[1][2])&&within_30(8)((gameWidth_22-25))(Ball$Tuple2$xyTuple2$vxvy_66[1][1]));
           var vx__77=stepVelocity_31(Ball$Tuple2$xyTuple2$vxvy_66[2][1])(hitPaddle1_75)(hitPaddle2_76);
           var vy__78=stepVelocity_31(Ball$Tuple2$xyTuple2$vxvy_66[2][2])((compare(Ball$Tuple2$xyTuple2$vxvy_66[1][2])(7)[0] === 'LT'))((compare(Ball$Tuple2$xyTuple2$vxvy_66[1][2])((gameHeight_23-7))[0] === 'GT'));
           var scored_79=((compare(Ball$Tuple2$xyTuple2$vxvy_66[1][1])(gameWidth_22)[0] === 'GT')||(compare(Ball$Tuple2$xyTuple2$vxvy_66[1][1])(0)[0] === 'LT'));
           var x__80=(scored_79?halfWidth_24:(Ball$Tuple2$xyTuple2$vxvy_66[1][1]+(vx__77*delta_65)));
           var y__81=(scored_79?halfHeight_25:(Ball$Tuple2$xyTuple2$vxvy_66[1][2]+(vy__78*delta_65)));
           return ["Tuple3",Ball_17(["Tuple2",x__80,y__81])(["Tuple2",vx__77,vy__78]),((compare(Ball$Tuple2$xyTuple2$vxvy_66[1][1])(gameWidth_22)[0] === 'GT')?1:0),((compare(Ball$Tuple2$xyTuple2$vxvy_66[1][1])(0)[0] === 'LT')?1:0)];}();
         }
         throw "Non-exhaustive pattern match in case";}();
        }
        throw "Non-exhaustive pattern match in case";}();
       }break;
      }break;
     }
     throw "Non-exhaustive pattern match in case";}();};};};};
 function stepGame_33(Input$deltaKeyInput$spacedir1dir2_82){
  return function(GameState$stateScore$s1s2ballpaddle1paddle2_83){
   return function(){
   switch(Input$deltaKeyInput$spacedir1dir2_82[0]){
    case "Input":
    switch(Input$deltaKeyInput$spacedir1dir2_82[2][0]){
     case "KeyInput":
     return function(){
     switch(GameState$stateScore$s1s2ballpaddle1paddle2_83[0]){
      case "GameState":
      switch(GameState$stateScore$s1s2ballpaddle1paddle2_83[2][0]){
       case "Score":
       return function(){
        var Tuple3$ball_s1_s2__94=(eq(GameState$stateScore$s1s2ballpaddle1paddle2_83[1],Play_19)?stepBall_32(Input$deltaKeyInput$spacedir1dir2_82[1])(GameState$stateScore$s1s2ballpaddle1paddle2_83[3])(GameState$stateScore$s1s2ballpaddle1paddle2_83[4])(GameState$stateScore$s1s2ballpaddle1paddle2_83[5]):["Tuple3",GameState$stateScore$s1s2ballpaddle1paddle2_83[3],0,0]);
        var ball__95=function(){
        switch(Tuple3$ball_s1_s2__94[0]){
         case "Tuple3":
         return Tuple3$ball_s1_s2__94[1];
        }
        throw "Non-exhaustive pattern match in case";}();
        var s1__96=function(){
        switch(Tuple3$ball_s1_s2__94[0]){
         case "Tuple3":
         return Tuple3$ball_s1_s2__94[2];
        }
        throw "Non-exhaustive pattern match in case";}();
        var s2__97=function(){
        switch(Tuple3$ball_s1_s2__94[0]){
         case "Tuple3":
         return Tuple3$ball_s1_s2__94[3];
        }
        throw "Non-exhaustive pattern match in case";}();
        var state__98=function(){
        switch(GameState$stateScore$s1s2ballpaddle1paddle2_83[1][0]){
         case "BetweenRounds":
         return (Input$deltaKeyInput$spacedir1dir2_82[2][1]?Play_19:GameState$stateScore$s1s2ballpaddle1paddle2_83[1]);
         case "Play":
         return (not(eq(s1__96,s2__97))?BetweenRounds_20:GameState$stateScore$s1s2ballpaddle1paddle2_83[1]);
        }
        throw "Non-exhaustive pattern match in case";}();
        return GameState_21(state__98)(Score_18((GameState$stateScore$s1s2ballpaddle1paddle2_83[2][1]+s1__96))((GameState$stateScore$s1s2ballpaddle1paddle2_83[2][2]+s2__97)))(ball__95)(stepPaddle_27(Input$deltaKeyInput$spacedir1dir2_82[1])(Input$deltaKeyInput$spacedir1dir2_82[2][2])(GameState$stateScore$s1s2ballpaddle1paddle2_83[4]))(stepPaddle_27(Input$deltaKeyInput$spacedir1dir2_82[1])(Input$deltaKeyInput$spacedir1dir2_82[2][3])(GameState$stateScore$s1s2ballpaddle1paddle2_83[5]));}();
      }break;
     }
     throw "Non-exhaustive pattern match in case";}();
    }break;
   }
   throw "Non-exhaustive pattern match in case";}();};};
 function scoreBoard_35(w_108){
  return function(inPlay_109){
   return function(p1_110){
    return function(p2_111){
     return function(){
      var code_112=function(x){
       return text(monospace(toText(x)));};
      var msg_114=function(x){
       return width(w_108)(centeredText(monospace(x)));}(toText("Press SPACE to begin"));
      var board_115=flow(right)(["Cons",stack_113(Value.str("W"))(Value.str("S")),["Cons",spacer(20)(1),["Cons",function(x){
       return text(Text.height(4)(toText(x)));}(Value.append(show(p1_110),Value.append(Value.str("    "),show(p2_111)))),["Cons",spacer(20)(1),["Cons",stack_113(Value.str("&uarr;"))(Value.str("&darr;")),["Nil"]]]]]]);
      var score_116=container(w_108)(heightOf(board_115))(midTop)(board_115);
      function stack_113(top_117){
       return function(bottom_118){
        return flow(down)(["Cons",code_112(Value.str(" ")),["Cons",code_112(top_117),["Cons",code_112(bottom_118),["Nil"]]]]);};};
      return (inPlay_109?score_116:above(score_116)(msg_114));}();};};};};
 function display_36(Tuple2$wh_119){
  return function(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_120){
   return function(){
   switch(Tuple2$wh_119[0]){
    case "Tuple2":
    return function(){
    switch(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_120[0]){
     case "GameState":
     switch(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_120[2][0]){
      case "Score":
      switch(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_120[3][0]){
       case "Ball":
       switch(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_120[4][0]){
        case "Paddle":
        switch(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_120[5][0]){
         case "Paddle":
         return layers(["Cons",function(){
          var pongGreen_129=rgb(60)(100)(60);
          return container(Tuple2$wh_119[1])(Tuple2$wh_119[2])(middle)(collage(gameWidth_22)(gameHeight_23)(["Cons",filled(pongGreen_129)(rect(gameWidth_22)(gameHeight_23)(["Tuple2",halfWidth_24,halfHeight_25])),["Cons",filled(white)(oval(15)(15)(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_120[3][1])),["Cons",filled(white)(rect(10)(40)(["Tuple2",20,GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_120[4][1]])),["Cons",filled(white)(rect(10)(40)(["Tuple2",(gameWidth_22-20),GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_120[5][1]])),["Nil"]]]]]));}(),["Cons",scoreBoard_35(Tuple2$wh_119[1])(eq(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_120[1],Play_19))(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_120[2][1])(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_120[2][2]),["Nil"]]]);
        }break;
       }break;
      }break;
     }break;
    }
    throw "Non-exhaustive pattern match in case";}();
   }
   throw "Non-exhaustive pattern match in case";}();};};
 lift(function(v) { var e = document.createEvent('Event');e.initEvent('desiredFPS', true, true);e.value = v;document.dispatchEvent(e); return v; })(desiredFPS_0);
 lift(function(v) { var e = document.createEvent('Event');e.initEvent('finished', true, true);e.value = v;document.dispatchEvent(e); return v; })(done_38);
 return {desiredFPS:desiredFPS_0,jsTime:jsTime_1,time:time_2,delta:delta_3,Up:Up_4,Neutral:Neutral_5,Down:Down_6,KeyInput:KeyInput_7,defaultKeyInput:defaultKeyInput_8,updateDirection:updateDirection_9,updateDirection1:updateDirection1_10,updateDirection2:updateDirection2_11,updateInput:updateInput_12,keyInput:keyInput_13,Input:Input_14,input:input_15,Paddle:Paddle_16,Ball:Ball_17,Score:Score_18,Play:Play_19,BetweenRounds:BetweenRounds_20,GameState:GameState_21,gameWidth:gameWidth_22,gameHeight:gameHeight_23,halfWidth:halfWidth_24,halfHeight:halfHeight_25,defaultGame:defaultGame_26,stepPaddle:stepPaddle_27,makePositive:makePositive_28,makeNegative:makeNegative_29,within:within_30,stepVelocity:stepVelocity_31,stepBall:stepBall_32,stepGame:stepGame_33,gameState:gameState_34,scoreBoard:scoreBoard_35,display:display_36,view:view_37,done:done_38,main:main_39};}();
Elm.main=function(){
 return Elm.Pong.main;};
} catch (e) {Elm.main=function() {var msg = ('<br/><h2>Your browser may not be supported. Are you using a modern browser?</h2>' + '<br/><span style="color:grey">Runtime Error in Pong module:<br/>' + e + '<br/><br/>The problem may stem from an improper usage of:<br/>Win.dimensions, above, snd</span>');document.body.innerHTML = Text.monospace(msg);throw e;};}</script><div id="widthChecker" style="width:100%; height:1px; position:absolute; top:-1px;"></div><div id="content"></div><script type="text/javascript">Dispatcher.initialize()</script><noscript><p> </p><p>Press SPACE to begin</p><p>W</p><p>S</p><p>    </p><p>&uarr;</p><p>&darr;</p></noscript></body></html>