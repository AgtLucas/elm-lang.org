<!DOCTYPE HTML>
<html><head><meta charset="UTF-8"><title>Pong</title><style type="text/css">html,head,body { padding:0; margin:0; }body { font-family: helvetica, arial, sans-serif; }</style></head><body><script type="text/javascript" src="/elm-mini.js"></script><script type="text/javascript">try{if(Elm.Pong)throw "Module name collision, 'Pong' is already defined.";Elm.Pong=function(){var $op={};for(Elm['i'] in Elm)eval('var '+Elm['i']+'=Elm[Elm.i];');try{if(!(Elm.Prelude instanceof Object))throw 'module not found'}catch(e){throw ("Module 'Prelude' is missing. Compile with --make flag or load missing module in a separate JavaScript file.")};var hiddenVars={};for(Elm['i'] in Elm.Prelude){if(hiddenVars[Elm['i']])continue;eval('var '+Elm['i']+' = Elm.Prelude[Elm.i];')};try{if(!(Elm.JavaScript instanceof Object))throw 'module not found'}catch(e){throw ("Module 'JavaScript' is missing. Compile with --make flag or load missing module in a separate JavaScript file.")};var hiddenVars={};for(Elm['i'] in Elm.JavaScript){if(hiddenVars[Elm['i']])continue;eval('var '+Elm['i']+' = Elm.JavaScript[Elm.i];')};try{if(!(Elm.Keyboard.Raw instanceof Object))throw 'module not found'}catch(e){throw ("Module 'Keyboard.Raw' is missing. Compile with --make flag or load missing module in a separate JavaScript file.")};var hiddenVars={};for(Elm['i'] in Elm.Keyboard.Raw){if(hiddenVars[Elm['i']])continue;eval('var '+Elm['i']+' = Elm.Keyboard.Raw[Elm.i];')};var Up_2=["Up"],Neutral_3=["Neutral"],Down_4=["Down"]
function KeyInput_5(a1){return function(a2){return function(a3){return ["KeyInput",a1,a2,a3]}}}
function Input_12(a1){return function(a2){return ["Input",a1,a2]}}
function Paddle_14(a1){return ["Paddle",a1]}
function Ball_15(a1){return function(a2){return ["Ball",a1,a2]}}
function Score_16(a1){return function(a2){return ["Score",a1,a2]}};var Play_17=["Play"],BetweenRounds_18=["BetweenRounds"]
function GameState_19(a1){return function(a2){return function(a3){return function(a4){return function(a5){return ["GameState",a1,a2,a3,a4,a5]}}}}};var time_0=lift(function(t_36){return(t_36/1000)})(Time.fps(60)),delta_1=lift(snd)(foldp(function(t1_37){return function(Tuple2$t0d_38){return function(){switch(Tuple2$t0d_38[0]){case"Tuple2":return ["Tuple2",t1_37,(t1_37-Tuple2$t0d_38[1])]};throw "Non-exhaustive pattern match in case"}()}})(["Tuple2",0,0])(time_0)),defaultKeyInput_6=KeyInput_5(false)(Neutral_3)(Neutral_3),updateDirection1_8=updateDirection_7(87)(83),updateDirection2_9=updateDirection_7(38)(40),keyInput_11=lift(foldl(updateInput_10)(defaultKeyInput_6))(keysDown),input_13=sampleOn(delta_1)(lift2(Input_12)(delta_1)(keyInput_11)),gameWidth_20=600,gameHeight_21=400,halfWidth_22=(gameWidth_20/2),halfHeight_23=(gameHeight_21/2),defaultGame_24=GameState_19(BetweenRounds_18)(Score_16(0)(0))(Ball_15(["Tuple2",halfWidth_22,halfHeight_23])(["Tuple2",150,150]))(Paddle_14(halfHeight_23))(Paddle_14(halfHeight_23)),gameState_32=foldp(stepGame_31)(defaultGame_24)(input_13),main_35=lift2(display_34)(Window.dimensions)(gameState_32)
function updateDirection_7(upKey_41){return function(downKey_42){return function(key_43){return function(direction_44){return function(){switch(direction_44[0]){case"Down":return(eq(key_43,upKey_41)?Neutral_3:Down_4);case"Neutral":return(eq(key_43,upKey_41)?Up_2:(eq(key_43,downKey_42)?Down_4:Neutral_3));case"Up":return(eq(key_43,downKey_42)?Neutral_3:Up_2)};throw "Non-exhaustive pattern match in case"}()}}}}
function updateInput_10(key_45){return function(KeyInput$spacedir1dir2_46){return function(){switch(KeyInput$spacedir1dir2_46[0]){case"KeyInput":return KeyInput_5((KeyInput$spacedir1dir2_46[1]||eq(key_45,32)))(updateDirection1_8(key_45)(KeyInput$spacedir1dir2_46[2]))(updateDirection2_9(key_45)(KeyInput$spacedir1dir2_46[3]))};throw "Non-exhaustive pattern match in case"}()}}
function stepPaddle_25(delta_50){return function(dir_51){return function(Paddle$y_52){return function(){switch(Paddle$y_52[0]){case"Paddle":return function(){switch(dir_51[0]){case"Down":return Paddle_14(clamp(20)((gameHeight_21-20))((Paddle$y_52[1]+(200*delta_50))));case"Neutral":return Paddle_14(Paddle$y_52[1]);case"Up":return Paddle_14(clamp(20)((gameHeight_21-20))((Paddle$y_52[1]-(200*delta_50))))};throw "Non-exhaustive pattern match in case"}()};throw "Non-exhaustive pattern match in case"}()}}}
function makePositive_26(n_54){return((compare(n_54)(0)[0]==='GT')?n_54:(0-n_54))}
function makeNegative_27(n_55){return((compare(n_55)(0)[0]==='GT')?(0-n_55):n_55)}
function within_28(epsilon_56){return function(n_57){return function(x_58){return((compare(x_58)((n_57-epsilon_56))[0]==='GT')&&(compare(x_58)((n_57+epsilon_56))[0]==='LT'))}}}
function stepVelocity_29(velocity_59){return function(lowerCollision_60){return function(upperCollision_61){return(lowerCollision_60?makePositive_26(velocity_59):(upperCollision_61?makeNegative_27(velocity_59):velocity_59))}}}
function stepBall_30(delta_62){return function(Ball$Tuple2$xyTuple2$vxvy_63){return function(Paddle$y1_64){return function(Paddle$y2_65){return function(){switch(Ball$Tuple2$xyTuple2$vxvy_63[0]){case"Ball":switch(Ball$Tuple2$xyTuple2$vxvy_63[1][0]){case"Tuple2":switch(Ball$Tuple2$xyTuple2$vxvy_63[2][0]){case"Tuple2":return function(){switch(Paddle$y1_64[0]){case"Paddle":return function(){switch(Paddle$y2_65[0]){case"Paddle":return function(){var hitPaddle1_72=(within_28(20)(Paddle$y1_64[1])(Ball$Tuple2$xyTuple2$vxvy_63[1][2])&&within_28(8)(25)(Ball$Tuple2$xyTuple2$vxvy_63[1][1])),hitPaddle2_73=(within_28(20)(Paddle$y2_65[1])(Ball$Tuple2$xyTuple2$vxvy_63[1][2])&&within_28(8)((gameWidth_20-25))(Ball$Tuple2$xyTuple2$vxvy_63[1][1])),vx__74=stepVelocity_29(Ball$Tuple2$xyTuple2$vxvy_63[2][1])(hitPaddle1_72)(hitPaddle2_73),vy__75=stepVelocity_29(Ball$Tuple2$xyTuple2$vxvy_63[2][2])((compare(Ball$Tuple2$xyTuple2$vxvy_63[1][2])(7)[0]==='LT'))((compare(Ball$Tuple2$xyTuple2$vxvy_63[1][2])((gameHeight_21-7))[0]==='GT')),scored_76=((compare(Ball$Tuple2$xyTuple2$vxvy_63[1][1])(gameWidth_20)[0]==='GT')||(compare(Ball$Tuple2$xyTuple2$vxvy_63[1][1])(0)[0]==='LT')),x__77=(scored_76?halfWidth_22:(Ball$Tuple2$xyTuple2$vxvy_63[1][1]+(vx__74*delta_62))),y__78=(scored_76?halfHeight_23:(Ball$Tuple2$xyTuple2$vxvy_63[1][2]+(vy__75*delta_62)));return ["Tuple3",Ball_15(["Tuple2",x__77,y__78])(["Tuple2",vx__74,vy__75]),((compare(Ball$Tuple2$xyTuple2$vxvy_63[1][1])(gameWidth_20)[0]==='GT')?1:0),((compare(Ball$Tuple2$xyTuple2$vxvy_63[1][1])(0)[0]==='LT')?1:0)]}()};throw "Non-exhaustive pattern match in case"}()};throw "Non-exhaustive pattern match in case"}()};break};break};throw "Non-exhaustive pattern match in case"}()}}}}
function stepGame_31(Input$deltaKeyInput$spacedir1dir2_79){return function(GameState$stateScore$s1s2ballpaddle1paddle2_80){return function(){switch(Input$deltaKeyInput$spacedir1dir2_79[0]){case"Input":switch(Input$deltaKeyInput$spacedir1dir2_79[2][0]){case"KeyInput":return function(){switch(GameState$stateScore$s1s2ballpaddle1paddle2_80[0]){case"GameState":switch(GameState$stateScore$s1s2ballpaddle1paddle2_80[2][0]){case"Score":return function(){var Tuple3$ball_s1_s2__91=(eq(GameState$stateScore$s1s2ballpaddle1paddle2_80[1],Play_17)?stepBall_30(Input$deltaKeyInput$spacedir1dir2_79[1])(GameState$stateScore$s1s2ballpaddle1paddle2_80[3])(GameState$stateScore$s1s2ballpaddle1paddle2_80[4])(GameState$stateScore$s1s2ballpaddle1paddle2_80[5]):["Tuple3",GameState$stateScore$s1s2ballpaddle1paddle2_80[3],0,0]),ball__92=function(){switch(Tuple3$ball_s1_s2__91[0]){case"Tuple3":return Tuple3$ball_s1_s2__91[1]};throw "Non-exhaustive pattern match in case"}(),s1__93=function(){switch(Tuple3$ball_s1_s2__91[0]){case"Tuple3":return Tuple3$ball_s1_s2__91[2]};throw "Non-exhaustive pattern match in case"}(),s2__94=function(){switch(Tuple3$ball_s1_s2__91[0]){case"Tuple3":return Tuple3$ball_s1_s2__91[3]};throw "Non-exhaustive pattern match in case"}(),state__95=function(){switch(GameState$stateScore$s1s2ballpaddle1paddle2_80[1][0]){case"BetweenRounds":return(Input$deltaKeyInput$spacedir1dir2_79[2][1]?Play_17:GameState$stateScore$s1s2ballpaddle1paddle2_80[1]);case"Play":return(not(eq(s1__93,s2__94))?BetweenRounds_18:GameState$stateScore$s1s2ballpaddle1paddle2_80[1])};throw "Non-exhaustive pattern match in case"}();return GameState_19(state__95)(Score_16((GameState$stateScore$s1s2ballpaddle1paddle2_80[2][1]+s1__93))((GameState$stateScore$s1s2ballpaddle1paddle2_80[2][2]+s2__94)))(ball__92)(stepPaddle_25(Input$deltaKeyInput$spacedir1dir2_79[1])(Input$deltaKeyInput$spacedir1dir2_79[2][2])(GameState$stateScore$s1s2ballpaddle1paddle2_80[4]))(stepPaddle_25(Input$deltaKeyInput$spacedir1dir2_79[1])(Input$deltaKeyInput$spacedir1dir2_79[2][3])(GameState$stateScore$s1s2ballpaddle1paddle2_80[5]))}()};break};throw "Non-exhaustive pattern match in case"}()};break};throw "Non-exhaustive pattern match in case"}()}}
function scoreBoard_33(w_105){return function(inPlay_106){return function(p1_107){return function(p2_108){return function(){var code_109=function(x){return text(monospace(toText(x)))},msg_111=function(x){return width(w_105)(centeredText(monospace(x)))}(toText("Press SPACE to begin")),board_112=flow(right)(["Cons",stack_110(Value.str("W"))(Value.str("S")),["Cons",spacer(20)(1),["Cons",function(x){return text(Text.height(4)(toText(x)))}(Value.append(show(p1_107),Value.append(Value.str("    "),show(p2_108)))),["Cons",spacer(20)(1),["Cons",stack_110(Value.str("&uarr;"))(Value.str("&darr;")),["Nil"]]]]]]),score_113=container(w_105)(heightOf(board_112))(midTop)(board_112)
function stack_110(top_114){return function(bottom_115){return flow(down)(["Cons",code_109(Value.str(" ")),["Cons",code_109(top_114),["Cons",code_109(bottom_115),["Nil"]]]])}};return(inPlay_106?score_113:above(score_113)(msg_111))}()}}}}
function display_34(Tuple2$wh_116){return function(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_117){return function(){switch(Tuple2$wh_116[0]){case"Tuple2":return function(){switch(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_117[0]){case"GameState":switch(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_117[2][0]){case"Score":switch(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_117[3][0]){case"Ball":switch(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_117[4][0]){case"Paddle":switch(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_117[5][0]){case"Paddle":return layers(["Cons",function(){var pongGreen_126=rgb(60)(100)(60);return container(Tuple2$wh_116[1])(Tuple2$wh_116[2])(middle)(collage(gameWidth_20)(gameHeight_21)(["Cons",filled(pongGreen_126)(rect(gameWidth_20)(gameHeight_21)(["Tuple2",halfWidth_22,halfHeight_23])),["Cons",filled(white)(oval(15)(15)(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_117[3][1])),["Cons",filled(white)(rect(10)(40)(["Tuple2",20,GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_117[4][1]])),["Cons",filled(white)(rect(10)(40)(["Tuple2",(gameWidth_20-20),GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_117[5][1]])),["Nil"]]]]]))}(),["Cons",scoreBoard_33(Tuple2$wh_116[1])(eq(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_117[1],Play_17))(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_117[2][1])(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_117[2][2]),["Nil"]]])};break};break};break};break};throw "Non-exhaustive pattern match in case"}()};throw "Non-exhaustive pattern match in case"}()}};return {$op:{},time:time_0,delta:delta_1,Up:Up_2,Neutral:Neutral_3,Down:Down_4,KeyInput:KeyInput_5,defaultKeyInput:defaultKeyInput_6,updateDirection:updateDirection_7,updateDirection1:updateDirection1_8,updateDirection2:updateDirection2_9,updateInput:updateInput_10,keyInput:keyInput_11,Input:Input_12,input:input_13,Paddle:Paddle_14,Ball:Ball_15,Score:Score_16,Play:Play_17,BetweenRounds:BetweenRounds_18,GameState:GameState_19,gameWidth:gameWidth_20,gameHeight:gameHeight_21,halfWidth:halfWidth_22,halfHeight:halfHeight_23,defaultGame:defaultGame_24,stepPaddle:stepPaddle_25,makePositive:makePositive_26,makeNegative:makeNegative_27,within:within_28,stepVelocity:stepVelocity_29,stepBall:stepBall_30,stepGame:stepGame_31,gameState:gameState_32,scoreBoard:scoreBoard_33,display:display_34,main:main_35}}();Elm.main=function(){return Elm.Pong.main}}catch(e){Elm.main=function(){var msg=('<br/><h2>Your browser may not be supported. Are you using a modern browser?</h2>'+'<br/><span style="color:grey">Runtime Error in Pong module:<br/>'+e+'<br/><br/>The problem may stem from an improper usage of:<br/>Time.fps, above, snd</span>');document.body.innerHTML=Elm.Text.monospace(msg);throw e}}</script><div id="widthChecker" style="width:100%; height:1px; position:absolute; top:-1px;"></div><div id="content"></div><script type="text/javascript">Dispatcher.initialize()</script><noscript><p> </p><p>Press SPACE to begin</p><p>W</p><p>S</p><p>    </p><p>&uarr;</p><p>&darr;</p></noscript></body></html>