<!DOCTYPE HTML>
<html><head><meta charset="UTF-8"><title>Pong</title><style type="text/css">html,head,body { padding:0; margin:0; }body { font-family: helvetica, arial, sans-serif; }</style></head><body><script type="text/javascript" src="/elm-mini.js"></script><script type="text/javascript">try{if(Elm.Pong)throw "Module name collision, 'Pong' is already defined.";Elm.Pong=function(){var $op={};for(Elm['i'] in Elm)eval('var '+Elm['i']+'=Elm[Elm.i];');try{if(!(Elm.Prelude instanceof Object))throw 'module not found'}catch(e){throw ("Module 'Prelude' is missing. Compile with --make flag or load missing module in a separate JavaScript file.")};var hiddenVars={};for(Elm['i'] in Elm.Prelude){if(hiddenVars[Elm['i']])continue;eval('var '+Elm['i']+' = Elm.Prelude[Elm.i];')};try{if(!(Elm.JavaScript instanceof Object))throw 'module not found'}catch(e){throw ("Module 'JavaScript' is missing. Compile with --make flag or load missing module in a separate JavaScript file.")};var hiddenVars={};for(Elm['i'] in Elm.JavaScript){if(hiddenVars[Elm['i']])continue;eval('var '+Elm['i']+' = Elm.JavaScript[Elm.i];')};try{if(!(Elm.Keyboard.Raw instanceof Object))throw 'module not found'}catch(e){throw ("Module 'Keyboard.Raw' is missing. Compile with --make flag or load missing module in a separate JavaScript file.")};var hiddenVars={};for(Elm['i'] in Elm.Keyboard.Raw){if(hiddenVars[Elm['i']])continue;eval('var '+Elm['i']+' = Elm.Keyboard.Raw[Elm.i];')};var Up_1=['Up'],Neutral_2=['Neutral'],Down_3=['Down']
function KeyInput_4(a1){return function(a2){return function(a3){return ['KeyInput',a1,a2,a3]}}}
function Input_11(a1){return function(a2){return ['Input',a1,a2]}}
function Paddle_13(a1){return ['Paddle',a1]}
function Ball_14(a1){return function(a2){return ['Ball',a1,a2]}}
function Score_15(a1){return function(a2){return ['Score',a1,a2]}};var Play_16=['Play'],BetweenRounds_17=['BetweenRounds']
function GameState_18(a1){return function(a2){return function(a3){return function(a4){return function(a5){return ['GameState',a1,a2,a3,a4,a5]}}}}}
function updateDirection_6(upKey_35){return function(downKey_36){return function(key_37){return function(direction_38){return function(){switch(direction_38[0]){case'Down':return(eq(key_37,upKey_35)?Neutral_2:Down_3);case'Neutral':return(eq(key_37,upKey_35)?Up_1:(eq(key_37,downKey_36)?Down_3:Neutral_2));case'Up':return(eq(key_37,downKey_36)?Neutral_2:Up_1)};throw "Non-exhaustive pattern match in case"}()}}}}
function updateInput_9(key_39){return function(KeyInput$spacedir1dir2_40){return function(){switch(KeyInput$spacedir1dir2_40[0]){case'KeyInput':return KeyInput_4((KeyInput$spacedir1dir2_40[1]||eq(key_39,32)))(updateDirection1_7(key_39)(KeyInput$spacedir1dir2_40[2]))(updateDirection2_8(key_39)(KeyInput$spacedir1dir2_40[3]))};throw "Non-exhaustive pattern match in case"}()}}
function stepPaddle_24(delta_44){return function(dir_45){return function(Paddle$y_46){return function(){switch(Paddle$y_46[0]){case'Paddle':return function(){switch(dir_45[0]){case'Down':return Paddle_13(clamp(20)((gameHeight_20-20))((Paddle$y_46[1]+(200*delta_44))));case'Neutral':return Paddle_13(Paddle$y_46[1]);case'Up':return Paddle_13(clamp(20)((gameHeight_20-20))((Paddle$y_46[1]-(200*delta_44))))};throw "Non-exhaustive pattern match in case"}()};throw "Non-exhaustive pattern match in case"}()}}}
function makePositive_25(n_48){return((compare(n_48)(0)[0]==='GT')?n_48:(0-n_48))}
function makeNegative_26(n_49){return((compare(n_49)(0)[0]==='GT')?(0-n_49):n_49)}
function within_27(epsilon_50){return function(n_51){return function(x_52){return((compare(x_52)((n_51-epsilon_50))[0]==='GT')&&(compare(x_52)((n_51+epsilon_50))[0]==='LT'))}}}
function stepVelocity_28(velocity_53){return function(lowerCollision_54){return function(upperCollision_55){return(lowerCollision_54?makePositive_25(velocity_53):(upperCollision_55?makeNegative_26(velocity_53):velocity_53))}}}
function stepBall_29(delta_56){return function(Ball$Tuple2$xyTuple2$vxvy_57){return function(Paddle$y1_58){return function(Paddle$y2_59){return function(){switch(Ball$Tuple2$xyTuple2$vxvy_57[0]){case'Ball':switch(Ball$Tuple2$xyTuple2$vxvy_57[1][0]){case'Tuple2':switch(Ball$Tuple2$xyTuple2$vxvy_57[2][0]){case'Tuple2':return function(){switch(Paddle$y1_58[0]){case'Paddle':return function(){switch(Paddle$y2_59[0]){case'Paddle':return function(){var hitPaddle1_66=(within_27(20)(Paddle$y1_58[1])(Ball$Tuple2$xyTuple2$vxvy_57[1][2])&&within_27(8)(25)(Ball$Tuple2$xyTuple2$vxvy_57[1][1])),hitPaddle2_67=(within_27(20)(Paddle$y2_59[1])(Ball$Tuple2$xyTuple2$vxvy_57[1][2])&&within_27(8)((gameWidth_19-25))(Ball$Tuple2$xyTuple2$vxvy_57[1][1])),vx__68=stepVelocity_28(Ball$Tuple2$xyTuple2$vxvy_57[2][1])(hitPaddle1_66)(hitPaddle2_67),vy__69=stepVelocity_28(Ball$Tuple2$xyTuple2$vxvy_57[2][2])((compare(Ball$Tuple2$xyTuple2$vxvy_57[1][2])(7)[0]==='LT'))((compare(Ball$Tuple2$xyTuple2$vxvy_57[1][2])((gameHeight_20-7))[0]==='GT')),scored_70=((compare(Ball$Tuple2$xyTuple2$vxvy_57[1][1])(gameWidth_19)[0]==='GT')||(compare(Ball$Tuple2$xyTuple2$vxvy_57[1][1])(0)[0]==='LT')),x__71=(scored_70?halfWidth_21:(Ball$Tuple2$xyTuple2$vxvy_57[1][1]+(vx__68*delta_56))),y__72=(scored_70?halfHeight_22:(Ball$Tuple2$xyTuple2$vxvy_57[1][2]+(vy__69*delta_56)));return ['Tuple3',Ball_14(['Tuple2',x__71,y__72])(['Tuple2',vx__68,vy__69]),((compare(Ball$Tuple2$xyTuple2$vxvy_57[1][1])(gameWidth_19)[0]==='GT')?1:0),((compare(Ball$Tuple2$xyTuple2$vxvy_57[1][1])(0)[0]==='LT')?1:0)]}()};throw "Non-exhaustive pattern match in case"}()};throw "Non-exhaustive pattern match in case"}()};break};break};throw "Non-exhaustive pattern match in case"}()}}}}
function stepGame_30(Input$deltaKeyInput$spacedir1dir2_73){return function(GameState$stateScore$s1s2ballpaddle1paddle2_74){return function(){switch(Input$deltaKeyInput$spacedir1dir2_73[0]){case'Input':switch(Input$deltaKeyInput$spacedir1dir2_73[2][0]){case'KeyInput':return function(){switch(GameState$stateScore$s1s2ballpaddle1paddle2_74[0]){case'GameState':switch(GameState$stateScore$s1s2ballpaddle1paddle2_74[2][0]){case'Score':return function(){var Tuple3$ball_s1_s2__85=(eq(GameState$stateScore$s1s2ballpaddle1paddle2_74[1],Play_16)?stepBall_29(Input$deltaKeyInput$spacedir1dir2_73[1])(GameState$stateScore$s1s2ballpaddle1paddle2_74[3])(GameState$stateScore$s1s2ballpaddle1paddle2_74[4])(GameState$stateScore$s1s2ballpaddle1paddle2_74[5]):['Tuple3',GameState$stateScore$s1s2ballpaddle1paddle2_74[3],0,0]),ball__86=function(){switch(Tuple3$ball_s1_s2__85[0]){case'Tuple3':return Tuple3$ball_s1_s2__85[1]};throw "Non-exhaustive pattern match in case"}(),s1__87=function(){switch(Tuple3$ball_s1_s2__85[0]){case'Tuple3':return Tuple3$ball_s1_s2__85[2]};throw "Non-exhaustive pattern match in case"}(),s2__88=function(){switch(Tuple3$ball_s1_s2__85[0]){case'Tuple3':return Tuple3$ball_s1_s2__85[3]};throw "Non-exhaustive pattern match in case"}(),state__89=function(){switch(GameState$stateScore$s1s2ballpaddle1paddle2_74[1][0]){case'BetweenRounds':return(Input$deltaKeyInput$spacedir1dir2_73[2][1]?Play_16:GameState$stateScore$s1s2ballpaddle1paddle2_74[1]);case'Play':return(not(eq(s1__87,s2__88))?BetweenRounds_17:GameState$stateScore$s1s2ballpaddle1paddle2_74[1])};throw "Non-exhaustive pattern match in case"}();return GameState_18(state__89)(Score_15((GameState$stateScore$s1s2ballpaddle1paddle2_74[2][1]+s1__87))((GameState$stateScore$s1s2ballpaddle1paddle2_74[2][2]+s2__88)))(ball__86)(stepPaddle_24(Input$deltaKeyInput$spacedir1dir2_73[1])(Input$deltaKeyInput$spacedir1dir2_73[2][2])(GameState$stateScore$s1s2ballpaddle1paddle2_74[4]))(stepPaddle_24(Input$deltaKeyInput$spacedir1dir2_73[1])(Input$deltaKeyInput$spacedir1dir2_73[2][3])(GameState$stateScore$s1s2ballpaddle1paddle2_74[5]))}()};break};throw "Non-exhaustive pattern match in case"}()};break};throw "Non-exhaustive pattern match in case"}()}}
function scoreBoard_32(w_99){return function(inPlay_100){return function(p1_101){return function(p2_102){return function(){var code_103=function(x){return text(monospace(toText(x)))},msg_105=function(x){return width(w_99)(centeredText(monospace(x)))}(toText('Press SPACE to begin')),board_106=flow(right)(['Cons',stack_104(Value.str('W'))(Value.str('S')),['Cons',spacer(20)(1),['Cons',function(x){return text(Text.height(4)(toText(x)))}(Value.append(show(p1_101),Value.append(Value.str('    '),show(p2_102)))),['Cons',spacer(20)(1),['Cons',stack_104(Value.str('&uarr;'))(Value.str('&darr;')),['Nil']]]]]]),score_107=container(w_99)(heightOf(board_106))(midTop)(board_106)
function stack_104(top_108){return function(bottom_109){return flow(down)(['Cons',code_103(Value.str(' ')),['Cons',code_103(top_108),['Cons',code_103(bottom_109),['Nil']]]])}};return(inPlay_100?score_107:above(score_107)(msg_105))}()}}}}
function display_33(Tuple2$wh_110){return function(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_111){return function(){switch(Tuple2$wh_110[0]){case'Tuple2':return function(){switch(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_111[0]){case'GameState':switch(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_111[2][0]){case'Score':switch(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_111[3][0]){case'Ball':switch(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_111[4][0]){case'Paddle':switch(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_111[5][0]){case'Paddle':return layers(['Cons',function(){var pongGreen_120=rgb(60)(100)(60);return container(Tuple2$wh_110[1])(Tuple2$wh_110[2])(middle)(collage(gameWidth_19)(gameHeight_20)(['Cons',filled(pongGreen_120)(rect(gameWidth_19)(gameHeight_20)(['Tuple2',halfWidth_21,halfHeight_22])),['Cons',filled(white)(oval(15)(15)(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_111[3][1])),['Cons',filled(white)(rect(10)(40)(['Tuple2',20,GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_111[4][1]])),['Cons',filled(white)(rect(10)(40)(['Tuple2',(gameWidth_19-20),GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_111[5][1]])),['Nil']]]]]))}(),['Cons',scoreBoard_32(Tuple2$wh_110[1])(eq(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_111[1],Play_16))(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_111[2][1])(GameState$stateScore$p1p2Ball$pos_Paddle$y1Paddle$y2_111[2][2]),['Nil']]])};break};break};break};break};throw "Non-exhaustive pattern match in case"}()};throw "Non-exhaustive pattern match in case"}()}};var delta_0=lift(inSeconds)(fps(60)),defaultKeyInput_5=KeyInput_4(false)(Neutral_2)(Neutral_2),updateDirection1_7=updateDirection_6(87)(83),updateDirection2_8=updateDirection_6(38)(40),keyInput_10=lift(foldl(updateInput_9)(defaultKeyInput_5))(keysDown),input_12=sampleOn(delta_0)(lift2(Input_11)(delta_0)(keyInput_10)),gameWidth_19=600,gameHeight_20=400,halfWidth_21=(gameWidth_19/2),halfHeight_22=(gameHeight_20/2),defaultGame_23=GameState_18(BetweenRounds_17)(Score_15(0)(0))(Ball_14(['Tuple2',halfWidth_21,halfHeight_22])(['Tuple2',150,150]))(Paddle_13(halfHeight_22))(Paddle_13(halfHeight_22)),gameState_31=foldp(stepGame_30)(defaultGame_23)(input_12),main_34=lift2(display_33)(Window.dimensions)(gameState_31);return {$op:{},delta:delta_0,Up:Up_1,Neutral:Neutral_2,Down:Down_3,KeyInput:KeyInput_4,defaultKeyInput:defaultKeyInput_5,updateDirection:updateDirection_6,updateDirection1:updateDirection1_7,updateDirection2:updateDirection2_8,updateInput:updateInput_9,keyInput:keyInput_10,Input:Input_11,input:input_12,Paddle:Paddle_13,Ball:Ball_14,Score:Score_15,Play:Play_16,BetweenRounds:BetweenRounds_17,GameState:GameState_18,gameWidth:gameWidth_19,gameHeight:gameHeight_20,halfWidth:halfWidth_21,halfHeight:halfHeight_22,defaultGame:defaultGame_23,stepPaddle:stepPaddle_24,makePositive:makePositive_25,makeNegative:makeNegative_26,within:within_27,stepVelocity:stepVelocity_28,stepBall:stepBall_29,stepGame:stepGame_30,gameState:gameState_31,scoreBoard:scoreBoard_32,display:display_33,main:main_34}}();Elm.main=function(){return Elm.Pong.main}}catch(e){Elm.main=function(){var msg=('<br/><h2>Your browser may not be supported. Are you using a modern browser?</h2>'+'<br/><span style="color:grey">Runtime Error in Pong module:<br/>'+e+'<br/><br/>The problem may stem from an improper usage of:<br/>above, fps, inSeconds</span>');document.body.innerHTML=Elm.Text.monospace(msg);throw e}}</script><div id="widthChecker" style="width:100%; height:1px; position:absolute; top:-1px;"></div><div id="content"></div><script type="text/javascript">Dispatcher.initialize()</script><noscript><p> </p><p>Press SPACE to begin</p><p>W</p><p>S</p><p>    </p><p>&uarr;</p><p>&darr;</p></noscript></body></html>